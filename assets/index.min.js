const e=document.body,t=window.__CONFIG__.sitemap,n=e=>({...e,children:void 0}),o=(e,t)=>new Promise((n=>{fetch(e,t).then((l=>{if(l.ok)return n(l.json());o(e,t).then(n)})).catch((l=>{o(e,t).then(n)}))}));let l=window.location.pathname,a=!0,r=!0;const s=new Map,c=new Map,d=new Map;let h=[];const p=[];let u,v,g=0,w=!0;const f=(e,t)=>{const n=h.findIndex((t=>t.hash===e));-1!==n&&(h[n].reading=t)},b=e=>i.rootBounds.bottom-i.boundingClientRect.bottom>i.rootBounds.bottom/2,k=new IntersectionObserver((e=>{if(0===g)for(const e of h)e.reading=!1;for(const t of e)!0===t.isIntersecting?(f(t.target.id,!0),g++):(f(t.target.id,!1),w||g--);if(0===g&&v)for(let e=h.length-1;e>=0;e--){const t=v.querySelector("#"+h[e].hash)?.getBoundingClientRect();if(t&&t.top<=80){h[e].reading=!0;break}}w=!1,m.redraw()}),{root:document.getElementById("content"),rootMargin:"-80px 0px -20% 0px",threshold:1}),y=()=>{g=0,w=!0,h=[];for(const e of document.getElementById("article")?.querySelectorAll("h1[id], h2[id]")??[])h.push({label:e.textContent,level:"H1"===e.nodeName?1:2,hash:e.id,reading:!1}),k.observe(e);m.redraw()},x=(e,t)=>{0===e.type?(p.push(e.link),d.set(e.link,{...e,parent:n(t)})):c.set(e.link,{...e,parent:n(t),children:e.children.map(n)})},I=e=>{for(const t of e.children)x(t,e),1===t.type&&I(t)},B=()=>{for(const e of t)x(e,void 0),1===e.type&&I(e)},E=e=>{o(`/api/doc${e}.json`).then((t=>{s.set(e,t),r=!1,S()})).catch((()=>{s.set(e,void 0),r=!1,u=void 0,S()}))},C=()=>{const e=l,n=t=>{for(const o of t)if(1===o.type&&e.startsWith(o.link)&&"/"===e.substring(o.link)[0]){o.open=!0,n(o.children);break}};n(t)},M=e=>{C();const t=p.indexOf(e),n=t>0&&-1!==t?p[t-1]:null,o=t<p.length-1&&-1!==t?p[t+1]:null;u={...s.get(e),...d.get(e),...c.get(e),next:o,previous:n}},S=()=>{if(l=window.location.pathname,l.endsWith("/")&&l.length>1&&(l=l.slice(0,-1),history.replaceState({},"",l)),d.has(l)){if(a=!0,!s.has(l))return E(l);M(l)}else if(c.has(l)){if(a=!0,!s.has(l+"/"))return E(l+"/");s.get(l+"/")?M(l+"/"):(u=c.get(l),C())}else a=!1,u=void 0;m.redraw.sync(),y()},N=e=>{window.history.pushState({},e,e),e=window.location.pathname,S()},O=()=>{window.location.hash?document.getElementById(window.location.hash.substring(1))?.scrollIntoView():document.getElementById("content")?.scrollTo({top:0,behavior:"smooth"})},P={view:e=>m("svg",{fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",class:"arrow",onclick:e.attrs.onclick},m("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":2,d:"M9 5l7 7-7 7"}))},$={view:e=>m("div",{class:"category","max-height":""},e.attrs.children.map((t=>{if(0===t.type){if(e.attrs.level>1&&t.link===e.attrs.parent)return;return m("a",{href:t.link,class:t.link===l?"current-link":"",onclick:e=>{N(t.link),e.preventDefault()}},m("span",t.label))}if(1===t.type){const n=m($,{children:t.children,level:e.attrs.level+1,parent:t.link});return 0===e.attrs.level?[m("h1",t.label),n]:[m("a",{class:t.link===l?"current-link":"",open:t.open,href:t.link,onclick:e=>{e.preventDefault(),e.currentTarget===e.target&&(t.open=!0,N(t.link))}},[m("span",t.label),m(P,{onclick:()=>t.open=!t.open})]),n]}})))},_={view:()=>m("div",{class:"notfound"},[m("h1","O.o"),m("span","Page not found :/")])},j={view:e=>m("div",{class:"redirect",onclick:()=>N(e.attrs.child.link)},[m("span",e.attrs.child.label),m(P)])},D={view(e){const t=d.get(e.attrs.link);return m("div",{class:e.attrs.class,onclick:()=>N(e.attrs.link)},[m(P),m("div",[m("span",e.attrs.label+(t.parent?.label&&t.parent.label!==u.parent?.label?` - ${t.parent.label}`:"")),m("label",t.label)])])}},H={oncreate:()=>{Array.from(document.getElementsByClassName("category")).forEach((e=>e.style.setProperty("--max-height",e.offsetHeight+e.scrollHeight+100+"px")))},view:()=>m("nav",m($,{level:0,children:t,parent:""}))},T=()=>({view:()=>m("header",[m("div",{class:"menu"},[m("img",{src:"/icon.svg"}),m("h1","SimpleDocs")])])}),q={onupdate(){v=document.getElementById("content")},view:()=>m("div",{class:"content",id:"content"},[m("div",{class:"article",id:"article"},a&&u?0===u.type||u?.content?[m.trust(u?.content),m("div",{class:"bottom-nav"},[null!==u.previous?m(D,{class:"before",label:"Previous",link:u.previous}):void 0,null!==u.next?m(D,{class:"after",label:"Next",link:u.next}):void 0])]:m("div",{class:"redirects-column"},[m("h1",u.label),...u.children.map((e=>m(j,{child:e})))]):m(_))])},A={view:()=>m("aside",h.map((e=>m("a",{style:`--level:${e.level};`,href:`#${e.hash}`,class:e.reading?"active":""},e.label))))},R={view:()=>m("main",[m(T),m("div",{class:"body"},[m(H),m(q),m(A)])])};B(),S(),m.mount(document.body,R),window.onpopstate=()=>{S()},window.onhashchange=()=>{window.location.hash?document.getElementById(window.location.hash.substring(1))?.scrollIntoView():document.getElementById("content")?.scrollTo({top:0,behavior:"smooth"})};